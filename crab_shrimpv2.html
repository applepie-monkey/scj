<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æµ·æ´‹ç”Ÿç‰©ç‰¹å¾µåˆ†é¡æŒ‘æˆ°</title>
    <style>
        /* --- å…¨å±€è¨­å®šèˆ‡ iPad å„ªåŒ– --- */
        * {
            box-sizing: border-box;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            touch-action: none; /* ç¦æ­¢é è¨­æ‰‹å‹¢ï¼Œå®Œå…¨ç”± JS æ§åˆ¶ */
        }

        body {
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
            background-color: #f4f6f7;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-bottom: 100px; /* åº•éƒ¨ç•™ç™½ */
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 30px;
        }

        /* --- å•é¡Œå€å¡Šæ¨£å¼ --- */
        .question-section {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 850px;
            padding: 20px;
            margin-bottom: 40px; /* å€å¡Šé–“è· */
            border-left: 10px solid #3498db; /* è£é£¾ç·š */
        }

        .question-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        /* æ ¹æ“šå•é¡Œæ”¹è®Šé‚Šæ¡†é¡è‰² */
        .q-style-1 { border-left-color: #e74c3c; } /* ç´…è‰²ç³» */
        .q-style-2 { border-left-color: #f1c40f; } /* é»ƒè‰²ç³» */
        .q-style-3 { border-left-color: #8e44ad; } /* ç´«è‰²ç³» */

        /* --- ç±ƒå­å€åŸŸ --- */
        .baskets-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 20px;
        }

        .basket {
            flex: 1;
            background-color: #f9f9f9;
            border: 3px dashed #ccc;
            border-radius: 12px;
            min-height: 200px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.2s, background-color 0.2s;
        }

        .basket-header {
            font-weight: bold;
            font-size: 1.1rem;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            margin-bottom: 15px;
            text-align: center;
            width: 90%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* ç±ƒå­æ„Ÿæ‡‰é«˜äº® */
        .basket.active-zone {
            background-color: #e8f8f5;
            border-color: #1abc9c;
            transform: scale(1.02);
        }

        /* --- å‹•ç‰©æ±  --- */
        .pool {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            min-height: 80px;
        }

        /* --- å¯æ‹–æ›³å¡ç‰‡ --- */
        .draggable-item {
            background-color: white;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #34495e;
            cursor: grab;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }
        
        /* æ‹–æ›³æ™‚çš„æ‡¸æµ®ç‹€æ…‹ */
        .draggable-item.dragging {
            position: fixed;
            z-index: 9999;
            transform: scale(1.15) rotate(3deg);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            opacity: 0.9;
            pointer-events: none; /* è®“äº‹ä»¶ç©¿é€ */
        }

        /* æ”¾å…¥ç±ƒå­å¾Œçš„æ¨£å¼ */
        .basket .draggable-item {
            width: 100%;
            justify-content: center;
            margin-bottom: 8px;
            border-color: transparent;
            background-color: rgba(255,255,255,0.9);
        }

        /* --- ç±ƒå­æ¨™é¡Œé¡è‰²é…ç½® --- */
        /* Q1 */
        .header-q1-yes { background-color: #e74c3c; }
        .header-q1-no { background-color: #7f8c8d; }
        /* Q2 */
        .header-q2-yes { background-color: #f1c40f; color: #333; }
        .header-q2-no { background-color: #7f8c8d; }
        /* Q3 */
        .header-q3-yes { background-color: #8e44ad; }
        .header-q3-no { background-color: #7f8c8d; }

        .btn-reset {
            padding: 12px 30px;
            background-color: #34495e;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            margin-top: 20px;
            cursor: pointer;
        }

    </style>
</head>
<body>

    <h1>æµ·æ´‹ç”Ÿç‰©ç‰¹å¾µåˆ†é¡</h1>

    <div class="question-section q-style-1">
        <div class="question-title">1. èª°çš„èº«é«”å‘ˆæ©¢åœ“å½¢ï¼Ÿ</div>
        
        <div class="baskets-container">
            <div class="basket" data-group="q1">
                <div class="basket-header header-q1-yes">èº«é«”å‘ˆæ©¢åœ“å½¢</div>
            </div>
            <div class="basket" data-group="q1">
                <div class="basket-header header-q1-no">èº«é«”ä¸å‘ˆæ©¢åœ“å½¢</div>
            </div>
        </div>

        <div class="pool" data-group="q1">
            <div class="draggable-item">ğŸ¦€ èŸ¹</div>
            <div class="draggable-item">ğŸ¦ é¾è¦</div>
            <div class="draggable-item">ğŸ¦ ç€¨å°¿è¦</div>
            <div class="draggable-item">ğŸ¤ è¦</div>
        </div>
    </div>

    <div class="question-section q-style-2">
        <div class="question-title">2. èª°æœ‰é•·è§¸é¬šï¼Ÿ</div>
        
        <div class="baskets-container">
            <div class="basket" data-group="q2">
                <div class="basket-header header-q2-yes">æœ‰é•·è§¸é¬š</div>
            </div>
            <div class="basket" data-group="q2">
                <div class="basket-header header-q2-no">æ²’æœ‰é•·è§¸é¬š</div>
            </div>
        </div>

        <div class="pool" data-group="q2">
            <div class="draggable-item">ğŸ¦ é¾è¦</div>
            <div class="draggable-item">ğŸ¦ ç€¨å°¿è¦</div>
            <div class="draggable-item">ğŸ¤ è¦</div>
        </div>
    </div>

    <div class="question-section q-style-3">
        <div class="question-title">3. èª°æœ‰å¤§é‰—å­ï¼Ÿ</div>
        
        <div class="baskets-container">
            <div class="basket" data-group="q3">
                <div class="basket-header header-q3-yes">æœ‰å¤§é‰—å­</div>
            </div>
            <div class="basket" data-group="q3">
                <div class="basket-header header-q3-no">æ²’æœ‰å¤§é‰—å­</div>
            </div>
        </div>

        <div class="pool" data-group="q3">
            <div class="draggable-item">ğŸ¦ é¾è¦</div>
            <div class="draggable-item">ğŸ¤ è¦</div>
        </div>
    </div>

    <button class="btn-reset" onclick="location.reload()">å…¨éƒ¨é‡ç½®</button>

    <script>
        // --- æ ¸å¿ƒè®Šæ•¸ ---
        const draggables = document.querySelectorAll('.draggable-item');
        const baskets = document.querySelectorAll('.basket');
        const pools = document.querySelectorAll('.pool');
        const allDropZones = [...baskets, ...pools]; // æ‰€æœ‰å¯ä»¥æ”¾ç½®çš„åœ°æ–¹

        let currentDragItem = null;
        let initialParent = null; 
        let touchOffsetX = 0;
        let touchOffsetY = 0;

        // --- åˆå§‹åŒ–äº‹ä»¶ç›£è½ ---
        draggables.forEach(item => {
            // Touch Events (iPad)
            item.addEventListener('touchstart', handleTouchStart, { passive: false });
            item.addEventListener('touchmove', handleTouchMove, { passive: false });
            item.addEventListener('touchend', handleTouchEnd);
            
            // Mouse Events (PC)
            item.addEventListener('mousedown', handleMouseDown);
        });

        // --- è§¸æ§é‚è¼¯ ---
        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            startDrag(e.target.closest('.draggable-item'), touch.clientX, touch.clientY);
        }

        function handleTouchMove(e) {
            e.preventDefault();
            if (!currentDragItem) return;
            const touch = e.touches[0];
            moveDrag(touch.clientX, touch.clientY);
        }

        function handleTouchEnd(e) {
            if (!currentDragItem) return;
            const touch = e.changedTouches[0];
            endDrag(touch.clientX, touch.clientY);
        }

        // --- æ»‘é¼ é‚è¼¯ ---
        function handleMouseDown(e) {
            e.preventDefault();
            startDrag(e.target.closest('.draggable-item'), e.clientX, e.clientY);
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        }

        function onMouseMove(e) {
            if (!currentDragItem) return;
            moveDrag(e.clientX, e.clientY);
        }

        function onMouseUp(e) {
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('mouseup', onMouseUp);
            endDrag(e.clientX, e.clientY);
        }

        // --- æ ¸å¿ƒå‹•ä½œé‚è¼¯ ---

        function startDrag(element, clientX, clientY) {
            if(!element) return;
            currentDragItem = element;
            initialParent = element.parentNode;

            const rect = element.getBoundingClientRect();
            touchOffsetX = clientX - rect.left;
            touchOffsetY = clientY - rect.top;

            element.classList.add('dragging');
            element.style.left = (clientX - touchOffsetX) + 'px';
            element.style.top = (clientY - touchOffsetY) + 'px';

            document.body.appendChild(element); // ç§»è‡³é ‚å±¤
        }

        function moveDrag(clientX, clientY) {
            if (!currentDragItem) return;
            currentDragItem.style.left = (clientX - touchOffsetX) + 'px';
            currentDragItem.style.top = (clientY - touchOffsetY) + 'px';
            
            highlightZoneUnder(clientX, clientY);
        }

        function endDrag(clientX, clientY) {
            if (!currentDragItem) return;

            // éš±è—æ‹–æ›³ç‰©ä»¥åµæ¸¬ä¸‹æ–¹å…ƒç´ 
            currentDragItem.style.display = 'none';
            let elemBelow = document.elementFromPoint(clientX, clientY);
            currentDragItem.style.display = 'inline-flex';

            let targetZone = null;

            // åˆ¤æ–·ä¸‹æ–¹æ˜¯å¦ç‚ºæœ‰æ•ˆçš„æ”¾ç½®å€ (ç±ƒå­æˆ–æ± å­)
            if (elemBelow) {
                targetZone = elemBelow.closest('.basket') || elemBelow.closest('.pool');
            }

            // æ¸…ç†æ¨£å¼
            currentDragItem.classList.remove('dragging');
            currentDragItem.style.left = '';
            currentDragItem.style.top = '';
            allDropZones.forEach(z => z.classList.remove('active-zone'));

            // --- åˆ¤æ–·é‚è¼¯ ---
            // 1. æ˜¯å¦æœ‰ç›®æ¨™å€åŸŸ
            // 2. ç›®æ¨™å€åŸŸçš„ data-group æ˜¯å¦èˆ‡å¡ç‰‡çš„çˆ¶å±¤(é¡Œç›®)ä¸€è‡´ï¼Ÿ (é˜²æ­¢ Q1 çš„èŸ¹æ‹‰åˆ° Q3 çš„ç±ƒå­)
            const itemGroup = initialParent.getAttribute('data-group') || initialParent.closest('.question-section').querySelector('.pool').getAttribute('data-group');
            const targetGroup = targetZone ? targetZone.getAttribute('data-group') : null;

            if (targetZone && itemGroup === targetGroup) {
                targetZone.appendChild(currentDragItem);
            } else {
                // æ”¾éŒ¯ä½ç½®æˆ–è·¨å€æ”¾ç½® -> å½ˆå›åŸè™•
                initialParent.appendChild(currentDragItem);
            }

            currentDragItem = null;
            initialParent = null;
        }

        function highlightZoneUnder(x, y) {
            currentDragItem.style.display = 'none';
            let elemBelow = document.elementFromPoint(x, y);
            currentDragItem.style.display = 'inline-flex';

            allDropZones.forEach(z => z.classList.remove('active-zone'));

            if (elemBelow) {
                let zone = elemBelow.closest('.basket');
                // åªæœ‰ç•¶æ‹–æ›³ç‰©å±¬æ–¼è©²å•é¡Œçµ„åˆ¥æ™‚ï¼Œç±ƒå­æ‰ç™¼äº®
                if (zone) {
                    const itemGroup = initialParent.getAttribute('data-group') || initialParent.closest('.question-section').querySelector('.pool').getAttribute('data-group');
                    if (zone.getAttribute('data-group') === itemGroup) {
                        zone.classList.add('active-zone');
                    }
                }
            }
        }
    </script>
</body>
</html>