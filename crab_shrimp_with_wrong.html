<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æµ·æ´‹ç”Ÿç‰©åˆ†é¡æŒ‘æˆ°</title>
    <style>
        /* åŸºæœ¬è¨­å®šï¼šé˜²æ­¢ iPad ä¸Šçš„å½ˆæ€§æ»¾å‹•å½±éŸ¿æ‹–æ›³é«”é©— */
        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: #e0f7fa;
            margin: 0;
            padding: 20px;
            touch-action: pan-y; /* å…è¨±å‚ç›´æ»¾å‹•ï¼Œä½†ç¦æ­¢æ°´å¹³æ‰‹å‹¢å¹²æ“¾ */
            -webkit-user-select: none; /* ç¦æ­¢é¸å–æ–‡å­— */
            user-select: none;
        }

        h1 {
            text-align: center;
            color: #006064;
        }

        /* æ¯ä¸€é¡Œçš„å€å¡Š */
        .question-section {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 40px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .question-title {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 15px;
            font-weight: bold;
            border-left: 5px solid #00acc1;
            padding-left: 10px;
        }

        /* å‹•ç‰©å‡ºç™¼å€ */
        .source-area {
            background-color: #f5f5f5;
            border: 2px dashed #ccc;
            border-radius: 10px;
            min-height: 100px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        /* ç±ƒå­å€åŸŸ */
        .baskets-wrapper {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .basket {
            flex: 1;
            background-color: #fff9c4;
            border: 3px solid #fbc02d;
            border-radius: 10px;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
        }

        .basket h3 {
            margin: 0 0 10px 0;
            font-size: 1rem;
            text-align: center;
            color: #ef6c00;
        }

        .basket-content {
            width: 100%;
            flex-grow: 1;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-content: flex-start;
        }

        /* å‹•ç‰©å¡ç‰‡æ¨£å¼ */
        .animal {
            width: 80px;
            height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            margin: 5px;
            cursor: grab;
            touch-action: none; /* é—œéµï¼šç¦æ­¢ç€è¦½å™¨è™•ç†æ­¤å…ƒç´ çš„è§¸æ§ï¼Œäº¤çµ¦ JS */
            position: relative; /* ç‚ºäº†è®“ JS æ§åˆ¶çµ•å°ä½ç½® */
            z-index: 10;
        }

        .animal span.emoji {
            font-size: 40px;
            line-height: 1;
        }

        .animal span.name {
            font-size: 12px;
            color: #555;
            margin-top: 2px;
        }

        /* æ‹–æ›³ä¸­çš„æ¨£å¼ */
        .dragging {
            opacity: 0.8;
            transform: scale(1.1);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            z-index: 9999;
            position: fixed; /* æ‹–æ›³æ™‚è®Šæˆå›ºå®šå®šä½ï¼Œè„«é›¢æ–‡æª”æµ */
            pointer-events: none; /* è®“ä¸‹æ–¹çš„å…ƒç´ èƒ½è¢«åµæ¸¬åˆ° (é›–ç„¶å¾Œé¢ç”¨ JS è¨ˆç®—åº§æ¨™ï¼Œä½†é€™ä¹Ÿæ˜¯å¥½ç¿’æ…£) */
        }
        
        /* ä½”ä½ç¬¦ï¼Œç•¶å…ƒç´ è¢«æ‹–èµ°æ™‚ç•™åœ¨åŸåœ°çš„éš±å½¢æ¡†ï¼Œé˜²æ­¢æ’ç‰ˆè·³å‹• */
        .placeholder {
            width: 80px;
            height: 80px;
            margin: 5px;
            border-radius: 50%;
            background-color: rgba(0,0,0,0.05);
            border: 2px dashed #ddd;
        }

    </style>
</head>
<body>

    <h1>ğŸ¦€ æµ·æ´‹ç”Ÿç‰©åˆ†é¡éŠæˆ² ğŸ¦</h1>
    <p style="text-align: center; color: #666;">è«‹ç”¨æ‰‹æŒ‡å°‡å‹•ç‰©æ‹–åˆ°æ­£ç¢ºçš„ç±ƒå­è£¡</p>

    <div class="question-section">
        <div class="question-title">1. èª°çš„èº«é«”å‘ˆæ©¢åœ“å½¢ï¼Ÿ</div>
        <div class="source-area" id="source-1">
            <div class="animal" data-id="crab"><span class="emoji">ğŸ¦€</span><span class="name">èŸ¹</span></div>
            <div class="animal" data-id="lobster"><span class="emoji">ğŸ¦</span><span class="name">é¾è¦</span></div>
            <div class="animal" data-id="mantis"><span class="emoji">ğŸ¦</span><span class="name">ç€¨å°¿è¦</span></div>
            <div class="animal" data-id="shrimp"><span class="emoji">ğŸ¦</span><span class="name">è¦</span></div>
        </div>
        <div class="baskets-wrapper">
            <div class="basket">
                <h3>ç±ƒå­1ï¼šèº«é«”å‘ˆæ©¢åœ“å½¢</h3>
                <div class="basket-content" id="basket-1"></div>
            </div>
            <div class="basket">
                <h3>ç±ƒå­2ï¼šèº«é«”ä¸å‘ˆæ©¢åœ“å½¢</h3>
                <div class="basket-content" id="basket-2"></div>
            </div>
        </div>
    </div>

    <div class="question-section">
        <div class="question-title">2. èª°æœ‰é•·è§¸é¬šï¼Ÿ</div>
        <div class="source-area" id="source-2">
            <div class="animal" data-id="lobster"><span class="emoji">ğŸ¦</span><span class="name">é¾è¦</span></div>
            <div class="animal" data-id="mantis"><span class="emoji">ğŸ¦</span><span class="name">ç€¨å°¿è¦</span></div>
            <div class="animal" data-id="shrimp"><span class="emoji">ğŸ¦</span><span class="name">è¦</span></div>
        </div>
        <div class="baskets-wrapper">
            <div class="basket">
                <h3>ç±ƒå­3ï¼šæœ‰é•·è§¸é¬š</h3>
                <div class="basket-content" id="basket-3"></div>
            </div>
            <div class="basket">
                <h3>ç±ƒå­4ï¼šæ²’æœ‰é•·è§¸é¬š</h3>
                <div class="basket-content" id="basket-4"></div>
            </div>
        </div>
    </div>

    <div class="question-section">
        <div class="question-title">3. èª°æœ‰å¤§é‰—å­ï¼Ÿ</div>
        <div class="source-area" id="source-3">
            <div class="animal" data-id="lobster"><span class="emoji">ğŸ¦</span><span class="name">é¾è¦</span></div>
            <div class="animal" data-id="shrimp"><span class="emoji">ğŸ¦</span><span class="name">è¦</span></div>
        </div>
        <div class="baskets-wrapper">
            <div class="basket">
                <h3>ç±ƒå­5ï¼šæœ‰å¤§é‰—å­</h3>
                <div class="basket-content" id="basket-5"></div>
            </div>
            <div class="basket">
                <h3>ç±ƒå­6ï¼šæ²’æœ‰å¤§é‰—å­</h3>
                <div class="basket-content" id="basket-6"></div>
            </div>
        </div>
    </div>

    <div class="question-section">
        <div class="question-title">4. èª°æœ‰å°¾å·´ï¼Ÿ</div>
        <div class="source-area" id="source-4">
            <div class="animal" data-id="crab"><span class="emoji">ğŸ¦€</span><span class="name">èŸ¹</span></div>
            <div class="animal" data-id="lobster"><span class="emoji">ğŸ¦</span><span class="name">é¾è¦</span></div>
            <div class="animal" data-id="mantis"><span class="emoji">ğŸ¦</span><span class="name">ç€¨å°¿è¦</span></div>
            <div class="animal" data-id="shrimp"><span class="emoji">ğŸ¦</span><span class="name">è¦</span></div>
        </div>
        <div class="baskets-wrapper">
            <div class="basket">
                <h3>ç±ƒå­7ï¼šæœ‰å°¾å·´</h3>
                <div class="basket-content" id="basket-7"></div>
            </div>
            <div class="basket">
                <h3>ç±ƒå­8ï¼šæ²’æœ‰å°¾å·´</h3>
                <div class="basket-content" id="basket-8"></div>
            </div>
        </div>
    </div>

    <div class="question-section">
        <div class="question-title">5. èª°é«”å‹æ˜¯å°çš„ï¼Ÿ</div>
        <div class="source-area" id="source-5">
            <div class="animal" data-id="crab"><span class="emoji">ğŸ¦€</span><span class="name">èŸ¹</span></div>
            <div class="animal" data-id="lobster"><span class="emoji">ğŸ¦</span><span class="name">é¾è¦</span></div>
            <div class="animal" data-id="mantis"><span class="emoji">ğŸ¦</span><span class="name">ç€¨å°¿è¦</span></div>
            <div class="animal" data-id="shrimp"><span class="emoji">ğŸ¦</span><span class="name">è¦</span></div>
        </div>
        <div class="baskets-wrapper">
            <div class="basket">
                <h3>ç±ƒå­9ï¼šé«”å‹æ˜¯å°çš„</h3>
                <div class="basket-content" id="basket-9"></div>
            </div>
            <div class="basket">
                <h3>ç±ƒå­10ï¼šé«”å‹æ˜¯å¤§çš„</h3>
                <div class="basket-content" id="basket-10"></div>
            </div>
        </div>
    </div>

    <script>
        // å–å¾—æ‰€æœ‰å‹•ç‰©å…ƒç´ 
        const animals = document.querySelectorAll('.animal');
        
        let activeItem = null;
        let activePlaceholder = null;
        let initialParent = null;
        let touchOffsetX = 0;
        let touchOffsetY = 0;

        // ç‚ºæ¯å€‹å‹•ç‰©ç¶å®šè§¸æ§äº‹ä»¶
        animals.forEach(item => {
            // æ”¯æ´è§¸æ§è¢å¹• (iPad)
            item.addEventListener('touchstart', handleStart, {passive: false});
            item.addEventListener('touchmove', handleMove, {passive: false});
            item.addEventListener('touchend', handleEnd);
            
            // æ”¯æ´æ»‘é¼  (é›»è…¦æ¸¬è©¦ç”¨)
            item.addEventListener('mousedown', handleStart);
        });

        function handleStart(e) {
            e.preventDefault(); // é˜²æ­¢æ»¾å‹•
            const touch = e.touches ? e.touches[0] : e;
            const target = e.target.closest('.animal');

            if (!target) return;

            activeItem = target;
            initialParent = activeItem.parentNode;

            // å‰µå»ºä¸€å€‹ä½”ä½ç¬¦ç•™åœ¨åŸåœ°
            activePlaceholder = document.createElement('div');
            activePlaceholder.className = 'placeholder';
            initialParent.insertBefore(activePlaceholder, activeItem);

            // è¨ˆç®—é»æ“Šé»èˆ‡å…ƒç´ å·¦ä¸Šè§’çš„åç§»
            const rect = activeItem.getBoundingClientRect();
            touchOffsetX = touch.clientX - rect.left;
            touchOffsetY = touch.clientY - rect.top;

            // è¨­å®šæ‹–æ›³æ¨£å¼
            activeItem.classList.add('dragging');
            activeItem.style.left = (touch.clientX - touchOffsetX) + 'px';
            activeItem.style.top = (touch.clientY - touchOffsetY) + 'px';
            
            // å°‡å…ƒç´ ç§»åˆ° Body å°¾ç«¯ä»¥ç¢ºä¿å®ƒæµ®åœ¨æœ€ä¸Šå±¤
            document.body.appendChild(activeItem);

            if (!e.touches) { // å¦‚æœæ˜¯æ»‘é¼ ï¼Œéœ€è¦é¡å¤–ç¶å®šç§»å‹•äº‹ä»¶
                document.addEventListener('mousemove', handleMove);
                document.addEventListener('mouseup', handleEnd);
            }
        }

        function handleMove(e) {
            if (!activeItem) return;
            e.preventDefault();
            const touch = e.touches ? e.touches[0] : e;

            // æ›´æ–°ä½ç½®
            activeItem.style.left = (touch.clientX - touchOffsetX) + 'px';
            activeItem.style.top = (touch.clientY - touchOffsetY) + 'px';
        }

        function handleEnd(e) {
            if (!activeItem) return;
            
            const touch = e.changedTouches ? e.changedTouches[0] : e;
            
            // éš±è—æ‹–æ›³ç‰©ä»¥ä¾¿åµæ¸¬ä¸‹æ–¹çš„å…ƒç´  (elementFromPoint)
            activeItem.style.display = 'none';
            const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
            activeItem.style.display = 'flex';

            // å°‹æ‰¾æ˜¯å¦è½åœ¨ç±ƒå­å€åŸŸå…§
            const droppableBasket = elemBelow ? elemBelow.closest('.basket-content') : null;
            const sourceArea = elemBelow ? elemBelow.closest('.source-area') : null;

            // é‚è¼¯ï¼š
            // 1. å¦‚æœè½åœ¨ç±ƒå­è£¡ -> æ”¾å…¥ç±ƒå­
            // 2. å¦‚æœè½åœ¨å‡ºç™¼å€ -> æ”¾å›å‡ºç™¼å€
            // 3. å¦‚æœäº‚ä¸Ÿ -> æ”¾å›åŸä¾†çš„åœ°æ–¹ (ç„¡è«–æ˜¯ç±ƒå­é‚„æ˜¯å‡ºç™¼å€)
            
            if (droppableBasket) {
                droppableBasket.appendChild(activeItem);
            } else if (sourceArea) {
                sourceArea.appendChild(activeItem);
            } else {
                // æ”¾å›åŸæœ¬çš„ä½ç½® (ç”¨ä½”ä½ç¬¦æ‰¾ä½ç½®)
                if (activePlaceholder && activePlaceholder.parentNode) {
                    activePlaceholder.parentNode.insertBefore(activeItem, activePlaceholder);
                } else {
                    initialParent.appendChild(activeItem);
                }
            }

            // æ¸…ç†æ¨£å¼
            activeItem.classList.remove('dragging');
            activeItem.style.position = '';
            activeItem.style.left = '';
            activeItem.style.top = '';
            activeItem.style.zIndex = '';
            
            // ç§»é™¤ä½”ä½ç¬¦
            if (activePlaceholder && activePlaceholder.parentNode) {
                activePlaceholder.parentNode.removeChild(activePlaceholder);
            }

            // æ¸…ç†è®Šæ•¸èˆ‡äº‹ä»¶
            activeItem = null;
            activePlaceholder = null;
            initialParent = null;
            
            document.removeEventListener('mousemove', handleMove);
            document.removeEventListener('mouseup', handleEnd);
        }
    </script>
</body>
</html>